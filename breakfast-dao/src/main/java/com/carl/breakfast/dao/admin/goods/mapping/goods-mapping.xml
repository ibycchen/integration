<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.carl.breakfast.dao.admin.goods.GoodsDao">
    <!--表明-->
    <sql id="table_name">
        MALL_GOODS
    </sql>

    <!--保存方法-->
    <insert id="saveBase" useGeneratedKeys="true" keyProperty="id" parameterType="com.carl.breakfast.dao.admin.goods.pojo.GoodsPojo">
        INSERT INTO <include refid="table_name"/>
                (ID, NAME, TITLE, SUB_TITLE, STOCK, CREATE_USER, PRICE, GOODS_TYPE, MAIN_IMG_ID, MAIN_IMG_PATH, NOTE)
        VALUES (#{id}, #{name}, #{title}, #{subTitle},#{stock}, #{createUser}, #{price}, #{goodsType}, #{mainImgId}, #{mainImgPath}, #{note})
    </insert>

    <!--保存方法-->
    <insert id="saveActual" parameterType="com.carl.breakfast.dao.admin.goods.pojo.GoodsPojo">
        INSERT INTO MALL_GOODS_ACTUAL
        (GOODS_ID, STOCK, PRICE, USE_DATE)
        VALUES (#{id}, #{stock}, #{price}, CurDate())
    </insert>

    <!--保存扩展信息-->
    <insert id="saveExt">
        INSERT INTO MALL_GOODS_EXT
        (GOODS_ID, KEY_NAME, KEY_AS, VAL)
        VALUES (#{goodsId}, #{keyName}, #{keyAs}, #{val})
    </insert>

    <!--查询总数-->
    <select id="selectGoodsCountByName" resultType="java.lang.Integer">
        SELECT COUNT(1) FROM <include refid="table_name"/>
        <where>
            <if test="name != null">
                NAME LIKE CONCAT('%','${name}','%' )
            </if>
        </where>
    </select>

    <!--查询总数-->
    <select id="selectGoodsByName" resultType="map">
        SELECT
          *
        FROM <include refid="table_name"/>

    </select>
</mapper>
